auth = "pam[gid-min=1000]"

tcp-port = {{ vpn_port }}

run-as-user = nobody
run-as-group = daemon

socket-file = /run/ocserv.socket

server-cert = {{ vpn_server_cert }}
server-key = {{ vpn_server_private_key }}

isolate-workers = true

max-clients = 4
max-same-clients = 2

server-stats-reset-time = 604800

keepalive = 30

dpd = 60
mobile-dpd = 300

switch-to-tcp-timeout = 25

try-mtu-discovery = true

cert-user-oid = 0.9.2342.19200300.100.1.1

compression = true
no-compress-limit = 256

tls-priorities = "NORMAL:%SERVER_PRECEDENCE:%COMPAT:-RSA:-VERS-SSL3.0:-ARCFOUR-128"

auth-timeout = 10
idle-timeout = 1200
mobile-idle-timeout = 1800

min-reauth-time = 300

max-ban-score = 80
ban-reset-time = 300

cookie-timeout = 300

deny-roaming = false

rekey-time = 172800
rekey-method = ssl

use-occtl = true

pid-file = /run/ocserv.pid

#
# Network settings
#

device = vpns
predictable-ips = true
default-domain = {{ vpn_domain }}

ipv4-network = {{ vpn_network }}

tunnel-all-dns = true
dns = 8.8.8.8
dns = 1.1.1.1

ping-leases = false

# route = 10.0.0.0/8
# route = 172.16.0.0/12
# route = 192.168.0.0/16

cisco-client-compat = false

dtls-legacy = false
